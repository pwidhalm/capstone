import pandas as pd
import json
from bs4 import BeautifulSoup
import requests
from pandas.io.json import json_normalize
import time

Wait_Time = 60
Number_of_Times = 90

minutes=0

def get_data():
    url = "https://api.coinmarketcap.com/v1/ticker/"
    response = requests.get(url)
    soup = BeautifulSoup(response.content, "html.parser")
    dic = json.loads(soup.prettify())

    df = pd.DataFrame.from_dict(json_normalize(dic), orient='columns')

    #location = 'f:/data/'+str(time.time())+'.csv'
    localtime = time.asctime(time.localtime(time.time()))
    localtime = localtime.replace(':',"_")
    location = 'f:/data/'+ localtime + '.csv'
    df.to_csv(location)
    time.sleep(Wait_Time)

while minutes < Number_of_Times:
    get_data()
    minutes+=1





